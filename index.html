
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Wordsearch by Nika Shum</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background-color: #0d0d0d;
      font-family: 'Courier New', Courier, monospace;
      color: white;
      height: 100%;
      overflow: hidden;
    }
    .container {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: stretch;
      height: 100%;
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
      gap: 20px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(10, 1fr);
      gap: 3px;
      max-width: 70vw;
      flex: 1;
    }
    .cell {
      aspect-ratio: 1;
      background-color: #111;
      border: 1px solid #00ffff33;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #00ffff;
      font-size: 2.2vw;
      text-transform: uppercase;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .cell.selected {
      background-color: #00ffff33;
    }
    .cell.found {
      background-color: #00ffcc55;
      border: 1px solid #00ffcc;
    }
    .cell.rainbow {
      animation: rainbow 1.5s infinite alternate;
    }
    @keyframes rainbow {
      0% { color: red; }
      20% { color: orange; }
      40% { color: yellow; }
      60% { color: green; }
      80% { color: blue; }
      100% { color: violet; }
    }
    .wordlist {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      flex: 1;
    }
    .word {
      background: #1a1a1a;
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid #00ffff33;
      font-size: 1.3vw;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
    }
    .word.found {
      text-decoration: line-through;
      opacity: 0.6;
    }
    .editor {
      display: none;
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.7);
      padding: 10px;
      border-radius: 10px;
      font-size: 14px;
      max-width: 300px;
      z-index: 9999;
    }
    .editor textarea, .editor input {
      width: 100%;
      margin-bottom: 6px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="grid" id="grid"></div>
    <div class="wordlist" id="wordlist"></div>
  </div>

  <div class="editor" id="editor">
    <div><strong>–°–ª–æ–≤–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</strong></div>
    <textarea id="wordsInput">hat,key,lamp,clue,door,map,ghost,code,trap,lock</textarea>
    <div><strong>–£—Ä–æ–≤–µ–Ω—å:</strong></div>
    <select id="levelSelect">
      <option value="easy">–ü—Ä–æ—Å—Ç–æ–π</option>
      <option value="medium" selected>–°—Ä–µ–¥–Ω–∏–π</option>
      <option value="hard">–°–ª–æ–∂–Ω—ã–π</option>
    </select>
    <div><strong>–§—Ä–∞–∑–∞ –ø–æ–±–µ–¥—ã:</strong></div>
    <input id="winText" value="üèÜ –ú–∏—Å—Å–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞! –¢—ã –Ω–∞—à—ë–ª –≤—Å–µ —Å–ª–æ–≤–∞. –ö–µ–π—Å —Ä–∞—Å–∫—Ä—ã—Ç." />
    <button onclick="startGame()">–û–±–Ω–æ–≤–∏—Ç—å</button>
  </div>

  <audio id="clickSound" src="https://upload.wikimedia.org/wikipedia/commons/3/3f/Button-click-sound.wav"></audio>
  <audio id="foundSound" src="https://upload.wikimedia.org/wikipedia/commons/b/b1/Ting-sound.mp3"></audio>
  <audio id="winSound" src="https://upload.wikimedia.org/wikipedia/commons/e/e7/Success-sound-effect.mp3"></audio>

  <script>
    const grid = document.getElementById("grid");
    const wordlist = document.getElementById("wordlist");
    const editor = document.getElementById("editor");

    const clickSound = document.getElementById("clickSound");
    const foundSound = document.getElementById("foundSound");
    const winSound = document.getElementById("winSound");

    const wordsInput = document.getElementById("wordsInput");
    const levelSelect = document.getElementById("levelSelect");
    const winTextInput = document.getElementById("winText");

    if (document.referrer.includes("genial.ly/editor") || window.location.search.includes("edit=1")) {
      editor.style.display = "block";
    }

    let selected = [];
    let foundWords = new Set();

    function getSettings() {
      return {
        words: wordsInput.value.toUpperCase().split(',').map(w => w.trim()),
        level: levelSelect.value,
        winText: winTextInput.value
      };
    }

    function clearSelection(red = false) {
      selected.forEach(c => {
        c.el.classList.remove("selected");
        if (red) {
          c.el.style.backgroundColor = "rgba(255,0,0,0.3)";
          setTimeout(() => c.el.style.backgroundColor = "", 300);
        }
      });
      selected = [];
    }

    function isLine(cells) {
      if (cells.length < 2) return true;
      const dx = cells[1].x - cells[0].x;
      const dy = cells[1].y - cells[0].y;
      for (let i = 1; i < cells.length; i++) {
        if (cells[i].x - cells[i - 1].x !== dx || cells[i].y - cells[i - 1].y !== dy) {
          return false;
        }
      }
      return true;
    }

    function startGame() {
      const settings = getSettings();
      localStorage.setItem("words", settings.words.join(","));
      localStorage.setItem("level", settings.level);
      localStorage.setItem("winText", settings.winText);

      grid.innerHTML = "";
      wordlist.innerHTML = "";
      selected = [];
      foundWords = new Set();

      const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      const size = 10;
      let data = Array.from({ length: size }, () =>
        Array.from({ length: size }, () => letters[Math.floor(Math.random() * 26)])
      );

      data.forEach((row, y) => {
        row.forEach((letter, x) => {
          const el = document.createElement("div");
          el.classList.add("cell");
          el.textContent = letter;
          el.addEventListener("click", () => {
            clickSound.play();
            if (el.classList.contains("found")) return;

            const already = selected.find(c => c.el === el);
            if (already) {
              el.classList.remove("selected");
              selected = selected.filter(c => c.el !== el);
              return;
            }
            el.classList.add("selected");
            selected.push({ el, x, y });

            const guess = selected.map(c => c.el.textContent).join("");

            if (!isLine(selected)) {
              if (guess.length >= 3) clearSelection(true);
              return;
            }

            if (settings.words.includes(guess)) {
              foundSound.play();
              selected.forEach(c => {
                c.el.classList.add("found");
                c.el.classList.remove("selected");
              });
              foundWords.add(guess);
              document.querySelectorAll(".word").forEach(w => {
                if (w.textContent === guess) w.classList.add("found");
              });
              selected = [];
              if (foundWords.size === settings.words.length) {
                winSound.play();
                document.querySelectorAll('.cell').forEach(c => c.classList.add('rainbow'));
                alert(settings.winText);
              }
            } else {
              const wrong = !settings.words.some(w => w.startsWith(guess));
              if (wrong && guess.length >= 3) clearSelection(true);
            }
          });
          grid.appendChild(el);
        });
      });

      settings.words.forEach(word => {
        const el = document.createElement("div");
        el.classList.add("word");
        el.textContent = word;
        wordlist.appendChild(el);
      });
    }

    const savedWords = localStorage.getItem("words");
    const savedLevel = localStorage.getItem("level");
    const savedWin = localStorage.getItem("winText");
    if (savedWords) wordsInput.value = savedWords;
    if (savedLevel) levelSelect.value = savedLevel;
    if (savedWin) winTextInput.value = savedWin;
    startGame();
  </script>
</body>
</html>
